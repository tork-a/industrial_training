# Linux のターミナル

> Linux のターミナル操作に慣れるようにします．


## ターミナルの起動

 1. ターミナルを開くには下記のアイコンをクリックします．

    ![](../../_static/ubuntu_terminal_icon.png)

 1. 2つ目のターミナルを次のいずれかの方法で開きます．

    * ターミナル上で右クリックして
      "Open Terminal" を選択する．
    * "File" メニューから
      "Open Terminal" を選択する．

 1. ターミナルウィンドウが選択されているときに
    "Ctrl+Shift+T" を押すと，
    同じウィンドウ内に2つ目のターミナルが開きます．

 1. 2つ目のターミナルのタブを次のいずれかの方法で閉じてください．

    * ターミナルタブにある小さな 'x' をクリックする．
      （メインのターミナルウィンドウの 'x' ではありません）
    * `exit` とタイプして Enter を押す．

 1. ウィンドウは次のような1行が表示されています．

    `ros-industrial@ros-i-kinetic-vm:~$`

 1. これは「プロンプト」と呼ばれるものでコマンドを入力する場所です．
    このプロンプトにはデフォルトでは3つの情報が表示されています．

    1. _ros-industrial_ は現在のユーザのログイン名です．
    1. _ros-i-kinetic-vm_ はコンピュータのホスト名です．
    1. ~ は現在のターミナルがいるディレクトリです．（後で詳述）

 1. `exit` を入力するか
    ウィンドウタイトルバーにある赤い 'x' をクリックして
    ターミナルウィンドウを閉じます．


## ディレクトリの移動とファイルのリスト表示

## 環境の準備

 1. ファイルブラウザでホームフォルダを開いてください．
 1. 前の演習で作成した `ex0.3` フォルダを
    ダブルクリックしてください．
    * このフォルダを利用してターミナルの
      さまざまなファイル操作を説明します．
 1. 現在のディレクトリでターミナルを開くために，
    ファイルブラウザのメインウィンドウで右クリックして
    "Open in Terminal" を選択してください．
 1. ターミナルウィンドウで次のコマンドを入力して
    この後の演習で使ういくつかのサンプルファイルを作成します．
    * `cp -a ~/industrial_training/exercises/0.3/. .`


### ls コマンド

 1. ターミナルで `ls` と入力してください．
    * `test.txt` と `new` がリスト表示されるはずです．
      （ `new` が表示されない場合は
        [前回の演習](Exploring-the-Linux-File-System_JP.md)
        を完遂してください．）
    * `new` のようなディレクトリは青色になっています．
    * ファイル `sample_job` は緑色になっています．
      これは「実行」のためのビットセットを有しているという印で，
      コマンドとして実行可能であることを意味しています．
 1. `ls *.txt` と入力してください．
    `test.txt` だけが表示されるはずです．
 1. `ls -l` とターミナルに入力してください．
    * `-l`オプションを追加すると，1行に1つのエントリが表示され，
      ディレクトリ内の各エントリに関する追加情報が表示されます．
    * 最初の10文字はファイルの種類とアクセス許可を示します．
    * エントリがディレクトリの場合，最初の文字は `d` です．
    * 次の9文字はファイルのパーミション（許可）ビットです．
    * 3番目と4番目のフィールドはそれぞれ所有するユーザーとグループです．
    * 2番目から最後までのフィールドは、ファイルが最後に更新された時刻です．
    * ファイルがシンボリックリンクの場合，
      リンクのファイル名の後ろにリンクのターゲットファイルがリストされます．
 1. `ls -a` とターミナルに入力してください．
    * ここでは隠しファイルが1つ追加で表示されます．
 1. `ls -a -l` もしくは `ls -al` とコマンド入力してください．
    * これで `hidden_link.txt` ファイルが
      `.hidden_text_file.txt` を指していることがわかります．


### `pwd` と `cd` コマンド

 1. `pwd` とターミナルに入力してください．
    * 現在の作業ディレクトリの完全なパスを表示します．
 1. `cd new` とターミナルに入力してください．
    * プロンプトが変わって
      `ros-industrial@ros-i-kinetic-vm:~/ex0.3/new$`
      と表示されるはずです．
    * ここで `pwd` を入力すると
      `/home/ros-industrial/ex0.3/new`
      ディレクトリにいることを表示します．
 1. `cd ..` とターミナルに入力してください．
    * [前の演習](Exploring-the-Linux-File-System_JP.md) で
      `..` が親フォルダであることを示しました．
    * プロンプトは現在の作業ディレクトリが
      `/home/ros-industrial/ex0.3`
      であることを示すはずです．
 1. `cd /bin` と入力してから
    `ls` を実行してください．
    * このフォルダには
      最も基本的な Linux コマンドのリストが含まれています．
      * _`pwd` と `ls` はこのフォルダにあります．_
 1. `cd ~/ex0.3` と入力して
    本演習の作業ディレクトリに戻ります．
    * Linux では `~` 文字を
      ホームディレクトリの省略表現として使用します．
    * コマンドラインのコマンドで
      ファイルとパスを参照する便利な方法です．
    * 本演習で沢山この `~` を入力しますので是非憶えてください．

_本節のコマンドの全オプションを知りたい場合は，
 コマンドラインに `man <command>` と入力します．
 （ `<command>` は欲しい情報があるコマンド名です．）
 これによりコマンドの組込みドキュメントが表示されます．
 スクロールするには矢印と Page Up/Down キーを使い，
 終了するには `q` を使います．_


## ファイルの変更

### mv コマンド

 1. `mv test.txt test2.txt` と入力してから
    `ls` を行ってください．
    * `test2.txt` にファイル名が変更されているはずです．<BR>
      _ここでは `mv` でファイル名を変更する方法を見ました．_
 1. `mv test2.txt new` と入力してから
    `ls` を行ってください．
    * ファイルがフォルダ内にないことがわかると思います．
 1. `cd new` と入力してから
    `ls` を行ってください．
    * フォルダ内にファイル `test2.txt` があるはずです．<BR>
      _ここでは `mv` でファイルを移動する方法を見ました．_
 1. `mv test2.txt ../test.txt` と入力してから
    `ls` を行ってください．
    * `test2.txt` はそこにはないはずです．
 1. `cd ..` と入力してから
    `ls` を行ってください．
    * `test.txt` が再び表示されているはずです．<BR>
      _ここでは `mv` で
       ファイル名の変更と移動を同時に行う方法を見ました．_

### cp コマンド

 1. `cp test.txt new/test2.txt` と入力してから
    `ls new` を行ってください．
    * `test2.txt` が `new` フォルダ内にあるはずです．
 1. `cp test.txt "test copy.txt"` と入力してから
    `ls -l` を行ってください．
    * `test.txt` が `test copy.txt` に
      コピーされているはずです．<BR>
    _引用符 `"` はスペースや特殊文字が
     ファイル名に含まれる場合に必要となります．_

### rm コマンド

 1. `rm "test copy.txt"` を入力してから
    `ls -l` を行ってください．
    * `test copy.txt` が無くなっているはずです．

### mkdir コマンド

 1. `mkdir new2` を入力してから
    `ls` を行ってください．
    * `new2` というフォルダができているはずです．

 _`-i` フラグを `cp` や `mv` および `rm` コマンドとともに使用すると，
 ファイルの上書きまたは削除を行うときに注意喚起されます．_


## ジョブの管理

### ジョブの停止

 1. `./sample_job` を実行してください．
    * プログラムが開始します．
 1. Control+C を押してください．
    * プログラムから抜けます．
 1. `./sample_job sigterm` を実行してください．
    * プログラムが開始します．
 1. Control+C を押してください．
    * 今回はプログラムは停止しません．


### 制御不能ジョブの停止

 1. 新たにターミナルのウィンドウを開きます．
 1. `ps ax` と入力してください．
 1. ターミナルをスクロールアップして
    `python ./sample_job sigterm` を見つけてください．
    * これは先程の1つ目のウィンドウで実行したジョブです．
    * テーブルの最初のフィールドはプロセス ID です．
      （ `man ps` で他のフィールドについても学習してください．）
 1. `ps ax | grep sample` と入力してください．
    * より少ない行が表示されているはずです．
    * これは特定のプロセスを見つけたい場合に便利です．
    * _注: これはパイピングという応用技術で，
      あるプログラムの出力が次のプログラムの入力に渡されます．
      これは本演習の目的の範囲を超えていますが，
      ターミナルをより広範に使用するようでしたら便利な機能です．_
 1. `kill <id>` と入力してください．
    `<id>` は `ps ax` で調べたジョブ番号です．
 1. 1つ目のターミナルで
    `./sample_job sigterm sigkill` と入力してください．
    * プログラムが開始されます．
 1. 2つ目のターミナルでプロセス ID を得るために
    `ps ax | grep sample` と入力してください．
 1. `kill <id>` と入力してください．
    * 今回はプロセスが終了しません．
 1. `kill -SIGKILL <id>` と入力してください．
    * 今回はプロセスが終了するはずです．


### プロセスとメモリの使用状況の表示

 1. ターミナルで `top` と入力してください．
    * テーブルが表示され，1秒につき1回更新されます．
      システムの全プロセスと
      全体の CPU と
      メモリの使用状況が表示されます．
 1. Shift+P キーを押してください．
    * これは CPU の利用割合の順番で並び替えを行います．<BR>
    _どのプロセスが最も CPU を使用しているかを判断するのに利用できます．_
 1. Shift+M キーを押してください．
    * これはメモリの利用割合の順番で並び替えを行います．<BR>
    _どのプロセスが最もメモリを使用しているかを判断するのに利用できます．_
 1. q か Ctrl+C でプログラムを終了します．


### テキストの編集とその他の GUI コマンド

 1. `gedit test.txt` と入力してください．
    * 新しくテキストエディタのウィンドウが開いて
      `test.txt` が読み込まれます．
    * ウィンドウを閉じるまで
      ターミナルのプロンプトは戻ってきません．
 1. プロンプトが戻ってくるようにする方法は
    2つありますので両方とも試してみてください．
    1. **プログラム開始と同時にプロンプトを回復させる:**
      1. `gedit test.txt &` と入力してください．
         * `&` の文字はコマンドの実行を
           バックグラウンドで行うことをターミナルに指定します．
           つまりプロンプトがすぐに戻ってくることを意味します．
      1. gedit ウィンドウを閉じて，
         ターミナルで `ls` と入力してください．
         * ターミナルにはファイルリストが表示されるだけでなく
           `gedit` が完了したことも通知されます．
    1. **既に開始しているプログラムをバックグラウンド実行に変更する:**
      1. `gedit test.txt` と入力してください．
         * ウィンドウが開いてターミナルでは
           プロンプトが待機状態にはなっていないはずです．
      1. ターミナルのウィンドウ内で Ctrl+Z を押してください．
         * ターミナルには `gedit` が終了した旨が表示されて，
           プロンプトが現れます．
      1. `gedit` ウィンドウを使ってみてください．
         * 一時停止状態のためウィンドウは動作しません．
      1. ターミナルで `bg` と入力してください．
         * `gedit` ウィンドウは動作をします．
      1. gedit ウィンドウを閉じて，
         ターミナルで `ls` と入力してください．
         * 前と同じようにターミナルには
           `gedit` が完了したことが通知されます．


### ルートとしてのコマンド実行

 1. ターミナルで `ls -a /root` と入力してください．
    * 端末は `/root` フォルダを読むことができないことを示します．
    * 普通のユーザーとしては実行できないコマンド
      を実行する必要がある場合が多くあり，
      その時は「スーパーユーザー」として
      コマンドを実行する必要があります．
 1. 前のコマンドを root として実行するには，
    コマンドの先頭に `sudo` を追加します．
    * この場合 `sudo ls -a /root` と入力してください．
    * 実行において端末はパスワードを要求します．
      （本例では `rosindustrial` ）
    * パスワードを入力すると，
      `/root` ディレクトリの内容が表示されます．

_**警告**:`sudo`は
 実行に際して指示の健全性のチェックを行わない
 強力なツールですので
 使用する際に **特に注意** してください．_
